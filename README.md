# カードカウンティングツール

React + TypeScript + Vite で構築した、48 枚デッキ用のシンプルなカウンティング & 期待値計算ツールです。UI は CSS Modules とシンプルなカスタムデザインで構成しており、完全静的なフロントエンドとしてホスティング可能です。  
公開版: https://leftonbo.github.io/kawauchi/

## 機能ハイライト

- 仕様に沿った 32 種類のカード定義を 1 箇所で管理
- 各シリーズをセクション分けし、1 枚ずつ色付きボタンを ON/OFF 切り替えして残り枚数を表現（資源名も色分け）
- アイテム 11 種 / 18 個も同様のグリッドでカウンティングし、使用時の期待食材量を自動集計
- 「みんなの大好物」は果物/お肉/魚チェックボックスで好みを指定し、救済系フラグもワンタップで制御
- 「季節の変わり目」ボタンを卓の状況ヘッダーに配置してワンクリックリセット（条件は維持）
- 次の 1 枚で得られる資源期待値・特殊カード確率をフッターにまとめ、右側では主に「資源が x 枚以上得られる確率」の表を表示
- アイテム確率・再行動確率・期待値計算は `calculateStats` に切り出し、Vitest で単体テスト済み

## 主要技術

- React 19 + TypeScript
- Vite 7
- CSS Modules（モダン UI のためにカスタムスタイリング）
- Vitest

## セットアップ

```bash
npm install
npm run dev   # ローカル開発サーバー
npm run test  # 期待値計算ロジックのユニットテスト
npm run lint  # ESLint
npm run build # 本番ビルド
```

## プロジェクト構成

- `src/data/cardDefinitions.ts` … カードデータと初期デッキ生成
- `src/data/itemDefinitions.ts` … アイテムデータと初期状態
- `src/utils/calculateStats.ts` … 期待値 / 確率の共通計算ロジック
- `src/utils/calculateItemStats.ts` … アイテム期待値計算
- `src/components/*` … CardGrid・ConditionPanel・StatsPanel など UI コンポーネント
- `src/utils/calculateStats.test.ts` … go-again 系や初期デッキの挙動を確認するテスト

## 留意点

- **1探検で資源が x 枚以上得られる確率**  
  各カードの獲得資源に「もう一度行動」効果（いってきまーす！・不思議な湧き水・地下探検セット等）で引く追加 1 枚ぶんの平均値を足した上で確率加重する近似モデルを採用しています（再帰的な連鎖は 1 回分のみ）。
- **1探検で得られる期待食材**  
  カード自身が生む果物/お肉/お魚の合計に、発見系アイテムを即時使用した場合の期待食材、および追加ドロー分の平均値を加算した値です。
- **特例処理**  
  「季節の変わり目」は「初期デッキに戻して 1 枚引く」ものとして初期デッキの期待値を再利用し、アイテムの ON/OFF 状態はリセットしません。

## 備考

- 画像は `/cards/xxx.png` のパスのみ定義し、存在しない場合はプレースホルダーを表示します。
- 「季節の変わり目」ボタンはカウンティング状態のみリセットし、条件チェックはリセットしません。
- 「いってきまーす！」系カードは 1 回だけ追加ドローを期待値に組み込む簡易モデルを採用しています。

## 作者・リンク

- 作成: [@pikachu0310VRC](https://x.com/pikachu0310VRC)
- GitHub: https://github.com/pikachu0310/kawauchi-counting-tool
